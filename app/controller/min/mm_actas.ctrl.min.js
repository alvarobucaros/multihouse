var app=angular.module("app",[]);app.controller("mainController",["$scope","$http",function(a,e){a.form_title="Actas de reunión",a.form_btnEdita="Edita",a.form_btnPrint="Imprime",a.form_btnActualiza="Habilita",a.form_btnCierra="Cierra Acta",a.form_btnRegreso="Cancela",a.form_agenda_comiteId="COMITE",a.tituloFormulario="",a.detail={},a.empresa=$("#e").val(),a.parametro="",a.nota="",a.acta=0,a.agenda_id=0,a.formato="",a.btnActualiza=!0;var o={agenda_comiteId:0};function t(){empresa=a.empresa,e.post("modulos/mod_mm_agendamiento.php?op=rc",{op:"rc",comite_Id:a.agenda_comiteId,empresa:empresa,param:"excluye"}).success(function(e){"No Hay"==e?alert("Este comité no tiene reuniones convocadas"):a.details=e})}!function(o){e.post("modulos/mod_mm_agendamiento.php?op=1",{op:"1",empresa:o}).success(function(e){a.operators1=e})}(a.empresa),a.show_form=!0,a.formToggle=function(){$("#idForm").slideToggle(),a.formato.$setPristine(),a.registro=angular.copy(o)},a.updateComite=function(){t()},a.cierraActa=function(o){agenda=a.agenda_id,param=a.parametro,aviso="Cierra acta "+a.acta+" "+a.nota,confirm(aviso+" continua?")&&(empresa=a.empresa,e.post("modulos/mod_mm_agendamiento.php?op=cra",{op:"cra",empresa:empresa,agenda:agenda}).success(function(a){alert(a)}))},a.editInfo=function(e){if(a.agenda_id=e.agenda_id,a.parametro="I",a.aviso="",a.nota=e.agenda_Descripcion,a.acta=e.agenda_acta,"S"==e.agenda_cierraActa&&(a.aviso="** ACTA CERRADA **"),a.tituloFormulario="Habilita "+e.agenda_Descripcion+" para modificarla o enviar nuevamente la citación ",""==e.agenda_observa.trim()){a.parametro="A";var o=e.agenda_fechaDesde.substr(0,10);a.tituloFormulario="Acta: "+e.agenda_acta+" del "+o+"\n"+e.agenda_Descripcion}a.showEdit=!0,a.btnActualiza=!0,"S"==e.agenda_cierraActa&&(a.btnActualiza=!1)},a.anulaRegistro=function(){a.showEdit=!1},a.actualizaRegistro=function(o){agenda=a.agenda_id,param=a.parametro,confirm("A esta acta se le podrá hacer modificaciones. Continua ?")&&e.post("modulos/mod_mm_agendamiento.php?op=ha",{op:"ha",agenda_id:agenda,parametro:param}).success(function(a){"Ok"===a?(t(),alert("Comité habilitado. ")):alert(a)})},a.printInfo=function(o){agenda=o.agenda_id;empresa=a.empresa,e.post("modulos/mod_mm_agendamiento.php?op=rfa",{op:"rfa",empresa:empresa,agenda:agenda}).success(function(e){a.formato=e,e}),confirm("Va a imprimir el acta. "+o.agenda_acta+" "+o.agenda_Descripcion+"...  Continua ?")&&(location.href="reports/rpt_mm_actas.php?op="+agenda+"&em="+empresa+"&em="+empresa+"&frm="+a.formato)}}]);