var app=angular.module("app",["ngResource"]);app.controller("mainController",["$scope","$http",function(e,t){var s;function a(s){t.post("modulos/mod_mm_asistentes.php?op=r",{op:"r",empresa:s}).success(function(t){e.details=t,e.configPages()})}e.form_title="Lista de asistentes permanentes por comité",e.form_btnNuevo="Nuevo registro",e.form_btnEdita="Edita",e.form_btnElimina="Elimina",e.form_btnAnula="Cerrar",e.form_btnActualiza="Actualizar",e.form_titModal="Actualiza lista de registros",e.form_Phbusca="Consulta",e.form_asistente_id="ID",e.form_asistente_comiteId="COMITE",e.form_asistente_usuarioId="USUARIO",e.form_asistente_nombre="NOMBRE",e.form_asistente_empresa="EMPRESA",e.form_asistente_cargo="CARGO",e.form_asistente_celuar="CELULAR",e.form_asistente_email="E_MAIL",e.form_asistente_titulo="TITULO EN REUNION",e.form_tituloP="Presidente",e.form_tituloS="Secretario",e.form_tituloT="Trascriptor",e.form_tituloN="Ninguno",e.form_Phasistente_id="Digite id",e.form_Phasistente_comiteId="Digite grupo",e.form_Phasistente_usuarioId="Digite usuario",e.form_Phasistente_nombre="Digite nombre",e.form_Phasistente_empresa="Digite empresa",e.form_Phasistente_cargo="Digite cargo",e.form_Phasistente_celuar="Digite celular",e.form_Phasistente_email="Digite e_mail",e.registro={},e.empresa=$("#e").val(),e.AsistenteForm=!1,e.chkTitulo=!0,e.currentPage=0,e.pageSize=10,e.pages=[],s=e.empresa,t.post("modulos/mod_mm_asistentes.php?op=0",{op:"0",empresa:s}).success(function(t){e.operators0=t}),t.post("modulos/mod_mm_asistentes.php?op=1",{op:"1",empresa:s}).success(function(t){e.operators1=t}),a(e.empresa),e.configPages=function(){e.pages.length=0;var t=e.currentPage-4,s=e.currentPage+5;t<1?(t=1,s=Math.ceil(e.details.length/e.pageSize)>10?10:Math.ceil(e.details.length/e.pageSize)):t>=Math.ceil(e.details.length/e.pageSize)-10&&(t=Math.ceil(e.details.length/e.pageSize)-10,s=Math.ceil(e.details.length/e.pageSize)),t<1&&(t=1);for(var a=t;a<=s;a++)e.pages.push({no:a});e.currentPage>=e.pages.length&&(e.currentPage=e.pages.length-1)},e.setPage=function(t){e.currentPage=t-1},e.changeUser=function(){t.post("modulos/mod_mm_asistentes.php?op=su",{op:"su",asistente_usuarioId:e.registro.asistente_usuarioId}).success(function(t){var s=t.length,a=t.substring(1,s-2),i=JSON.parse(a,function(e,t){return"fecha"==e?new Date(t):t});e.registro.asistente_nombre=i.usuario_nombre,e.registro.asistente_empresa=i.empresa_nombre,e.registro.asistente_email=i.usuario_email,e.registro.asistente_celuar=i.usuario_celular})},e.show_form=!0,e.formToggle=function(){e.formato.$setPristine(),e.registro={},e.registro.asistente_usuarioId=0,e.registro.asistente_id=0,e.AsistenteForm=!0},e.registro=[],e.editInfo=function(t){e.registro=t,e.registro.asistente_titulo=t.asistente_titulo.substr(0,1),e.AsistenteForm=!0},e.deleteInfo=function(s){e.empresa=$("#e").val(),confirm("Desea borrar el registro con nombre : "+s.asistente_nombre+" ?")&&t.post("modulos/mod_mm_asistentes.php?op=b",{op:"b",asistente_id:s.asistente_id}).success(function(t){"Ok"===t.trim()&&(a(e.empresa),alert("Registro Borrado "))})},e.updateInfo=function(s){er="",e.empresa=$("#e").val(),""===$("#asistente_id").val()&&(er+="falta id\n"),0===e.registro.asistente_comite&&(er+="falta comité\n"),""===$("#asistente_nombre").val()&&(er+="falta nombre\n"),""===$("#asistente_empresa").val()&&(er+="falta empresa\n"),""===$("#asistente_cargo").val()&&(er+="falta cargo\n"),""===$("#asistente_celuar").val()&&(er+="falta celular\n"),""===$("#asistente_email").val()&&(er+="falta e_mail\n"),void 0===s.asistente_titulo&&(s.asistente_titulo="N"),""===s.asistente_titulo&&(s.asistente_titulo="N"),""===er?t.post("modulos/mod_mm_asistentes.php?op=a",{op:"a",asistente_id:s.asistente_id,asistente_comite:s.asistente_comite,asistente_usuarioId:s.asistente_usuarioId,asistente_nombre:s.asistente_nombre,asistente_empresa:s.asistente_empresa,asistente_cargo:s.asistente_cargo,asistente_celuar:s.asistente_celuar,asistente_email:s.asistente_email,asistente_empresaId:e.empresa,asistente_titulo:s.asistente_titulo}).success(function(t){"Ok"===t.trim()&&(a(e.empresa),e.AsistenteForm=!1,alert("Registro Actualizado"))}):alert(er)},e.clearInfo=function(t){e.AsistenteForm=!1}}]),app.filter("startFromGrid",function(){return function(e,t){return t=+t,e.slice(t)}});