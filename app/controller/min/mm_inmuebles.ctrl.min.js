var app=angular.module("app",[]);app.controller("mainController",["$scope","$http",function(i,o){i.details=[],i.form_title="Inmuebles y propietarios",i.form_btnNuevo="Nuevo registro",i.form_btnEdita="Exporta",i.form_btnExpo="Edita",i.form_btnElimina="Elimina",i.form_btnExcel="Exporta Excel",i.form_btnAnula="Cerrar",i.form_btnActualiza="Actualizar",i.form_titModal="Actualiza lista de registros",i.form_Phbusca="Consulta",i.form_Activo0="SI",i.form_Activo1="NO",i.form_inmueble_id="ID",i.form_inmueble_empresa="EMPRESA",i.form_inmueble_codigo="INMUEBLE CODIGO",i.form_inmueble_descripcion="DESCRIPCION",i.form_inmueble_area="AREA",i.form_inmueble_coeficiente="COEFICIENTE",i.form_inmueble_ubicacion="UBICACION",i.form_inmueble_propNombre="PROPIETARIO NOMBRE",i.form_inmueble_propCedula="CEDULA",i.form_inmueble_propTelefonos="TELEFONOS",i.form_inmueble_propDireccion="DIRECCION",i.form_inmueble_propCorreo="E-MAIL",i.form_inmueble_Activo="ACTIVO",i.form_inmueble_comite="ASISTE AL COMITE",i.form_Phinmueble_id="Digite id",i.form_Phinmueble_empresa="Digite empresa",i.form_Phinmueble_codigo="Digite codigo",i.form_Phinmueble_descripcion="Digite descripcion",i.form_Phinmueble_area="Digite area",i.form_Phinmueble_coeficiente="Digite coeficiente",i.form_Phinmueble_ubicacion="Digite ubicacion",i.form_Phinmueble_propNombre="Digite nombre",i.form_Phinmueble_propCedula="Digite cedula",i.form_Phinmueble_propTelefonos="Digite telefonos",i.form_Phinmueble_propDireccion="Digite direccion",i.form_Phinmueble_propCorreo="Digite e-mail",i.form_Phinmueble_Activo="Digite activo",i.empresa=$("#e").val();var n={inmueble_id:0,inmueble_empresa:0,inmueble_codigo:"",inmueble_descripcion:"",inmueble_area:"",inmueble_coeficiente:"",inmueble_ubicacion:"",inmueble_propNombre:"",inmueble_propCedula:"",inmueble_propTelefonos:"",inmueble_propDireccion:"",inmueble_propCorreo:"",inmueble_Activo:"A"};function r(){cadena=$("#e").val(),o.post("modulos/mod_mm_inmuebles.php?op=r",{op:"r",cadena:cadena}).success(function(e){i.details=e,i.configPages()})}i.currentPage=0,i.pageSize=10,i.pages=[],r(),i.configPages=function(){i.pages.length=0;var e=i.currentPage-4,o=i.currentPage+5;e<1?(e=1,o=Math.ceil(i.details.length/i.pageSize)>10?10:Math.ceil(i.details.length/i.pageSize)):e>=Math.ceil(i.details.length/i.pageSize)-10&&(e=Math.ceil(i.details.length/i.pageSize)-10,o=Math.ceil(i.details.length/i.pageSize)),e<1&&(e=1);for(var n=e;n<=o;n++)i.pages.push({no:n});i.currentPage>=i.pages.length&&(i.currentPage=i.pages.length-1)},i.setPage=function(e){i.currentPage=e-1},i.exporta=function(){valor=confirm("Exporta la tabla de inmuebles y propietarios a Excel, continua?"),1==valor&&(empresa=$("#e").val(),o.post("modulos/mod_mm_inmuebles.php?op=exp",{op:"exp",empresa:empresa}).success(function(e){$("#miExcel").html(e),alert("exporta a Excel. Cargue y renombre el documento... "),window.open("data:application/vnd.ms-excel,"+encodeURIComponent($("#miExcel").html()))}))},i.show_form=!0,i.formToggle=function(){$("#idForm").slideToggle(),e=$("#e").val(),i.registro={},i.registro.inmueble_Activo120=!0,i.registro.inmueble_id=9,$("#idForm").css("display","none")},i.formToggle=function(){$("#idForm").slideToggle(),i.formato.$setPristine(),i.registro=angular.copy(n),i.registro.inmueble_id=0,myempre=$("#e").val(),i.registro.inmueble_empresa=myempre,i.registro.inmueble_Activo="A"},i.registro=function(e){o.post("modulos/mod_mm_inmuebles.php?op=a",{op:"a",inmueble_id:inmueble_id,inmueble_empresa:inmueble_empresa,inmueble_codigo:inmueble_codigo,inmueble_descripcion:inmueble_descripcion,inmueble_area:inmueble_area,inmueble_coeficiente:inmueble_coeficiente,inmueble_ubicacion:inmueble_ubicacion,inmueble_propNombre:inmueble_propNombre,inmueble_propCedula:inmueble_propCedula,inmueble_propTelefonos:inmueble_propTelefonos,inmueble_propDireccion:inmueble_propDireccion,inmueble_propCorreo:inmueble_propCorreo,inmueble_Activo:inmueble_Activo}).success(function(e){i.show_form=!0,alert(e),!0===e&&r()})},i.registro={},i.editInfo=function(e){i.registro=e,$("#idForm").slideToggle()},i.deleteInfo=function(e){confirm("Desea borrar el registro con nombre : "+e.inmueble_codigo+" ?")&&o.post("modulos/mod_mm_inmuebles.php?op=b",{op:"b",inmueble_id:e.inmueble_id}).success(function(e){"Ok"===e&&(r(),alert("Registro Borrado "))})},i.updateInfo=function(e){er="",""===$("#inmueble_id").val()&&(er+="falta id\n"),""===$("#inmueble_empresa").val()&&(er+="falta empresa\n"),""===$("#inmueble_codigo").val()&&(er+="falta codigo\n"),""===$("#inmueble_descripcion").val()&&(er+="falta descripcion\n"),""===$("#inmueble_area").val()&&(er+="falta area\n"),""===$("#inmueble_coeficiente").val()&&(er+="falta coeficiente\n"),""===$("#inmueble_ubicacion").val()&&(er+="falta ubicacion\n"),""===$("#inmueble_propNombre").val()&&(er+="falta nombre\n"),""===$("#inmueble_propCedula").val()&&(er+="falta cedula\n"),""===$("#inmueble_propTelefonos").val()&&(er+="falta telefonos\n"),""===$("#inmueble_propDireccion").val()&&(er+="falta direccion\n"),""===$("#inmueble_propCorreo").val()&&(er+="falta e-mail\n"),""===$("#inmueble_Activo").val()&&(er+="falta activo\n"),""==er?o.post("modulos/mod_mm_inmuebles.php?op=a",{op:"a",inmueble_id:e.inmueble_id,inmueble_empresa:e.inmueble_empresa,inmueble_codigo:e.inmueble_codigo,inmueble_descripcion:e.inmueble_descripcion,inmueble_area:e.inmueble_area,inmueble_coeficiente:e.inmueble_coeficiente,inmueble_ubicacion:e.inmueble_ubicacion,inmueble_propNombre:e.inmueble_propNombre,inmueble_propCedula:e.inmueble_propCedula,inmueble_propTelefonos:e.inmueble_propTelefonos,inmueble_propDireccion:e.inmueble_propDireccion,inmueble_propCorreo:e.inmueble_propCorreo,inmueble_Activo:e.inmueble_Activo}).success(function(e){"Ok"===e&&(r(),alert("Registro Actualizado "),$("#idForm").slideToggle())}):alert(er)},i.clearInfo=function(e){console.log("empty"),$("#idForm").slideToggle()}}]),app.filter("startFromGrid",function(){return function(e,i){return i=+i,e.slice(i)}});