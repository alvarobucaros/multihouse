var app=angular.module("app",[]);function vira(e){0===$("#ctrl").val()&&e>=3&&$(".ocul").hide()}app.controller("mainController",["$scope","$http",function(e,o){function i(i){e.registro.comite_empresa=i,o.post("modulos/mod_mm_comites.php?op=r",{op:"r",empresa:i}).success(function(o){vira(Object.keys(o).length),e.details=o,e.configPages()})}e.form_title="Lista de comités",e.form_btnNuevo="Nuevo registro",e.form_btnEdita="Edita",e.form_btnElimina="Elimina",e.form_btnAnula="Cerrar",e.form_btnActualiza="Actualizar",e.form_titModal="Actualiza lista de registros",e.form_Phbusca="Consulta",e.form_Activo40="SI",e.form_Activo41="NO",e.btnPaga="Hacer donación",e.btnNoPaga="Después",e.form_comite_id="ID",e.form_comite_empresa="EMPRESA",e.form_comite_nombre="NOMBRE",e.form_comite_descripcion="DESCRIPCION",e.form_comite_activo="ACTIVO",e.form_comite_lider="LIDER",e.form_comite_email="EMAIL",e.form_comite_consecActa="CONSECUTIVO ACTA",e.form_Phcomite_id="Digite id",e.form_Phcomite_empresa="Digite empresa",e.form_Phcomite_nombre="Digite nombre",e.form_Phcomite_descripcion="Digite descripcion",e.form_Phcomite_activo="Digite activo",e.form_Phcomite_lider="Digite lider",e.form_Phcomite_email="Digite email",e.form_Phcomite_consecActa="Digite consecacta",e.registro=[],e.empresa=$("#e").val(),e.AsistenteForm=!1,e.msg=!1,e.currentPage=0,e.pageSize=10,e.pages=[],i(e.empresa),e.empresa,e.configPages=function(){e.pages.length=0;var o=e.currentPage-4,i=e.currentPage+5;o<1?(o=1,i=Math.ceil(e.details.length/e.pageSize)>10?10:Math.ceil(e.details.length/e.pageSize)):o>=Math.ceil(e.details.length/e.pageSize)-10&&(o=Math.ceil(e.details.length/e.pageSize)-10,i=Math.ceil(e.details.length/e.pageSize)),o<1&&(o=1);for(var t=o;t<=i;t++)e.pages.push({no:t});e.currentPage>=e.pages.length&&(e.currentPage=e.pages.length-1)},e.setPage=function(o){e.currentPage=o-1},e.show_form=!0,e.formToggle=function(){$("#idForm").slideToggle(),e.formato.$setPristine(),e.registro={},e.registro.comite_activo="A",e.registro.comite_consecActa=0,e.registro.comite_empresa=e.empresa,e.registro.comite_id=0},e.registro={},e.editInfo=function(o){e.registro=o,$("#idForm").slideToggle()},e.deleteInfo=function(t){confirm("Desea borrar el registro con nombre : "+t.comite_nombre+" ?")&&o.post("modulos/mod_mm_comites.php?op=b",{op:"b",comite_id:t.comite_id}).success(function(o){"Ok"===o?(i(e.empresa),alert("Registro Borrado ")):alert("Comite "+t.comite_nombre+" "+o)})},e.updateInfo=function(t){er="",""===$("#comite_id").val()&&(er+="falta id\n"),""===$("#comite_empresa").val()&&(er+="falta empresa\n"),""===$("#comite_nombre").val()&&(er+="falta nombre\n"),""===$("#comite_descripcion").val()&&(er+="falta descripcion\n"),""===$("#comite_activo").val()&&(er+="falta activo\n"),""===$("#comite_lider").val()&&(er+="falta lider\n"),""===$("#comite_email").val()&&(er+="falta email\n"),""===$("#comite_consecActa").val()&&(er+="falta consecutivo\n"),""==er?o.post("modulos/mod_mm_comites.php?op=a",{op:"a",comite_id:t.comite_id,comite_empresa:t.comite_empresa,comite_nombre:t.comite_nombre,comite_descripcion:t.comite_descripcion,comite_activo:t.comite_activo,comite_lider:t.comite_lider,comite_email:t.comite_email,comite_consecActa:t.comite_consecActa}).success(function(o){"Ok"===o?(i(e.empresa),alert("Registro Actualizado "),$("#idForm").slideToggle()):"Lic"===o?e.msg=!0:alert(o)}):alert(er)},e.clearInfo=function(e){console.log("empty"),$("#idForm").slideToggle()},e.paga=function(){alert("payu"),e.msg=!1,alert("Nuevamente clic en Actualizar para guardar este comité ")},e.noPaga=function(){e.msg=!1}}]),app.filter("startFromGrid",function(){return function(e,o){return o=+o,e.slice(o)}});