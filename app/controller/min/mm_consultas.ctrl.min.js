var app=angular.module("app",[]);app.controller("mainController",["$scope","$http",function(a,e){a.form_title="Consultas ",a.form_subTitle="Consulta por comité según: Acta, fecha o tema",a.form_agenda_comiteId="Comite ",a.form_agenda_fechaDesde="Desde Fecha ",a.form_agenda_fechaHasta="Hasta Fecha ",a.form_agenda_actaDesde="Desde acta",a.form_agenda_actaHasta="Hasta acta",a.form_titTema="Tema",a.form_btnConsulta="Consulta";var o,t=new Date;anoHoy=t.getFullYear(),a.empresa=$("#e").val(),a.comiteId=0,a.registro1={},a.registro1.agenda_fechaDesde=anoHoy+"-01-01",a.registro1.agenda_fechaHasta=anoHoy+"-12-31",a.registro1.agenda_actaDesde=0,a.registro1.agenda_actaHasta=9999,a.registro1.tema="",o=a.empresa,e.post("modulos/mod_mm_agendamiento.php?op=1",{op:"1",empresa:o}).success(function(e){a.operators1=e}),a.agenda_fechaDesde=function(){a.registro1.agenda_fechaHasta=a.registro1.agenda_fechaDesde},a.updateComite=function(){a.comiteId=a.registro1.agenda_comiteId},a.editDetailResponse=function(e){agenda=e.agenda_id,empresa=a.empresa,confirm("Consulta el acta con la información ?")&&(location.href="reports/rpt_mm_actas.php?op="+agenda+"&em="+empresa)},a.creaSolicitud=function(o){er="",0==a.comiteId&&(er+="falta comite\n"),""==er?(dato=a.comiteId+"||"+a.registro1.agenda_actaDesde+"||"+a.registro1.agenda_actaHasta+"||"+a.registro1.agenda_fechaDesde+"||"+a.registro1.agenda_fechaHasta+"||"+a.registro1.tema+"||"+a.empresa,e.post("modulos/mod_mm_agendamiento.php?op=cnslta",{op:"cnslta",dato:dato}).success(function(e){a.detailResponses=e})):alert(er)},a.exportToExcel=function(o){dato=a.comiteId+"||"+a.registro1.agenda_actaDesde+"||"+a.registro1.agenda_actaHasta+"||"+a.registro1.agenda_fechaDesde+"||"+a.registro1.agenda_fechaHasta+"||"+a.registro1.tema+"||"+a.empresa,e.post("modulos/mod_mm_agendamiento.php?op=excel",{op:"excel",dato:dato}).success(function(a){$("#miExcel").html(a),alert("exporta a Excel. Cargue y renombre el documento... "),window.open("data:application/vnd.ms-excel,"+decodeURIComponent($("#miExcel").html()))})}}]);